@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Components.Forms
@namespace Blazr.App.FluentUI
@implements IDialogContentComponent<WeatherForecastId>
@inject IViewPresenter<DmoWeatherForecast, Guid> Presenter

<!-- Header -->
<FluentDialogHeader ShowDismiss="true">
    <FluentStack VerticalAlignment="VerticalAlignment.Center">
        <FluentIcon Value="@(new Icons.Regular.Size24.ContentView())" />
        <FluentLabel Typo="Typography.PaneHeader">
            @Dialog.Instance.Parameters.Title
        </FluentLabel>
    </FluentStack>
</FluentDialogHeader>

<!-- Body -->
<FluentDialogBody>
    <FluentGrid Spacing="1" AdaptiveRendering="true" >
        <FluentGridItem sm="12" md="6">
            <FluentTextField Style="width: 100%;"
                             Value="@this.Presenter.Item.Date.ToString("dd-MMM-yy")"
                             Label="Date"
                             ReadOnly />
        </FluentGridItem>
        <FluentGridItem sm="12" md="6">
            <FluentTextField Style="width: 100%;"
                             Value="@this.Presenter.Item.Summary"
                             Label="Summary"
                             ReadOnly />
        </FluentGridItem>
    </FluentGrid>
    <FluentGrid Spacing="1" AdaptiveRendering="true">
        <FluentGridItem sm="12" md="6">
            <FluentTextField Style="width: 100%;"
                             Value="@this.Presenter.Item.Temperature.TemperatureC.ToString("N0")"
                             Label="Temperature &deg; C"
                             ReadOnly />
        </FluentGridItem>
        <FluentGridItem sm="12" md="6">
            <FluentTextField Style="width: 100%;"
                             Value="@this.Presenter.Item.Temperature.TemperatureF.ToString("N0")"
                             Label="Temperature &deg; F"
                             ReadOnly />
        </FluentGridItem>
    </FluentGrid>
    <FluentGrid Spacing="1" AdaptiveRendering="true">
        <FluentGridItem sm="12" md="6">
            <FluentTextField Style="width: 100%;"
                             Value="@this.Presenter.Item.WeatherForecastId.Value.ToString()"
                             Label="Full Id"
                             ReadOnly />
        </FluentGridItem>
    </FluentGrid>
</FluentDialogBody>

<!-- Footer -->
<FluentDialogFooter>
    <FluentButton Appearance="Appearance.Accent" OnClick="@ExitAsync">
        Exit
    </FluentButton>
</FluentDialogFooter>

@code
{
    public readonly Guid ComponentId = Guid.NewGuid();
    private EditContext _editContext = default!;

    [CascadingParameter]
    public FluentDialog Dialog { get; set; } = default!;

    [Parameter]
    public WeatherForecastId Content { get; set; } = default!;

    protected async override Task OnInitializedAsync()
    {
        Console.WriteLine($"{this.ComponentId.ToString().Substring(0,8)} - {this.GetType().Name} - OnInitializedAsync ");
        await this.Presenter.LoadAsync(this.Content.Value);
        _editContext = new EditContext(Content);
    }

    private async Task ExitAsync()
    {
        await Dialog.CancelAsync();
    }
}
